{% extends 'base.html' %}

{% block header %}
<h1>{% block title %}Posts{% endblock %}</h1>
{% endblock %}

{% block content %}
<div>
  <!-- Search Bar -->
  <input type="text" id="search-bar" placeholder="Search posts by title..." onkeyup="filterPosts()" />
</div>

<!-- Results Container -->
<div id="posts-container">
  {% for post in posts %}
  <article class="post" data-title="{{ post['title'] }}">
    <header>
      <div>
        <h1>{{ post['title'] }}</h1>
      </div>
    </header>
    <p class="body">{{ post['body'] }}</p>
  </article>
  {% if not loop.last %}
  <hr>
  {% endif %}
  {% endfor %}
</div>
{% endblock %}

{% block scripts %}
<script>
  /**
   * Filters posts based on the search bar input.
   */
  function filterPosts() {
    const query = document
      .getElementById("search-bar")
      .value.toLowerCase();
    const posts = document.querySelectorAll("#posts-container .post");

    posts.forEach((post) => {
      const title = post.dataset.title.toLowerCase();
      if (title.includes(query)) {
        post.style.display = "block";
      } else {
        post.style.display = "none";
      }
    });
  }
</script>
{% endblock %}